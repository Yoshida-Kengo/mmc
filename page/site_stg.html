<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="ディスクリプション">
    <title>ページタイトル</title>
    <!--ページCSSの読み込み-->
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../home_style.css">

    <script>!(function(e,c,t){e.mc_queue=[],e.mc_tracker=function(){e.mc_queue.push(arguments)},(y=c.createElement(t)).type="text/javascript",y.src="https://event.stg.mcweb.micoworks-system.jp/ev/access/oMewo13KTtCaN39PPMkckA/micocloud.js",y.async=1,(b=c.getElementsByTagName(t)[0]).parentNode.insertBefore(y,b)})(window,document,"script")
    </script>

</head>
<body>
    <div>
        <div class="content">
            <h3>サイト：WEBタグ・イベントの動作チェック_STG</h3>
        </div>
        <div class="button" onclick="location.href='../index.html'">一覧へ戻る</div>
        <button id="clearCacheBtn">キャッシュをクリア</button>

        <div class="content">
            <h3>
                前提：MMCカスタマーIDまたはあとリビューショントークンが権限ONになっていること<br>
                説明：下記のボタンを押下することでWEBタグが発火します。</h3>
        </div>
        <!-- <div class="content">
            <a href="https://liff.line.me/2006155555-V5bZMNyo?st=mNtkeI8MQICLfXtvveh8Mg&lfm=Tuyoo3UfTnCGM8GphAV7rg&type=channel" class="btn">
                基本流入経路：LINEで開く</a>
        </div>  
        <div class="content">
            <a href="https://liff.line.me/2006155555-V5bZMNyo?st=mNtkeI8MQICLfXtvveh8Mg&lfm=DBxmT-AgQoOhfmq_uI417A&type=channel" class="btn">
                カスタム流入経路：LINEで開く</a>
        </div>
        <div class="content">
            <a href="https://liff.line.me/2006155555-V5bZMNyo?st=mNtkeI8MQICLfXtvveh8Mg&lfm=9DhBX5QiSfy0Yop4RMmDqQ&type=channel" class="btn">
                カスタム流入経路（複製）：LINEで開く</a>
        </div> -->

    </div>
    <div class="card-container">
        <script>
            let eventParam = [{
                eventValue : "login",
                eventName : "ログイン"
            },{
                eventValue : "logout",
                eventName : "ログアウト"
            },{
                eventValue : "register",
                eventName : "会員登録"
            },{
                eventValue : "unregister",
                eventName : "会員登録解除"
            },{
                eventValue : "add_cart",
                eventName : "カート商品追加"
            },{
                eventValue : "remove_cart",
                eventName : "カート商品削除"
            },{
                eventValue : "order",
                eventName : "注文"
            },{
                eventValue : "cancel_order",
                eventName   : "注文キャンセル"
            },{
                eventValue : "browse_lp",
                eventName : "LP閲覧"
            },{
                eventValue : "browse_product",
                eventName : "商品ページ閲覧"
            },{
                eventValue : "browse_price",
                eventName : "料金ページ閲覧"
            },{
                eventValue  : "browse_store",
                eventName : "店舗ページ閲覧"
            },{
                eventValue : "browse_reservation",
                eventName   : "予約・申し込みページ閲覧"
            },{
                eventValue  : "input_reservation",
                eventName : "予約・申し込みフォーム入力"
            },{
                eventValue : "confirm_reservation",
                eventName : "予約・申し込みフォーム確認"
            },{
                eventValue : "submit_reservation",
                eventName : "予約・申し込みフォーム送信"
            },{
                eventValue : "cancel_reservation",
                eventName : "予約・申し込みキャンセル"
            },{
                eventValue : "browse_inquiry",
                eventName : "問い合わせページ閲覧"
            },{
                eventValue : "input_inquiry",
                eventName : "問い合わせフォーム入力"
            },{
                eventValue  : "confirm_inquiry",
                eventName : "問い合わせフォーム確認"
            },{
                eventValue : "submit_inquiry",
                eventName : "問い合わせフォーム送信"
            },{
                eventValue : "add_favorite",
                eventName : "お気に入り追加"
            },{
                eventValue : "remove_favorite",
                eventName : "お気に入り解除"
            },{
                eventValue : "site_search",
                eventName : "サイト内検索"
            },{
                eventValue : "download_materials",
                eventName : "資料ダウンロード"
            }];

            for(var i=0;i<eventParam.length;i++) {
                document.write('<div class="card">');
                document.write('<h5>イベント' + eventParam[i].eventName + '</h5>');
                // document.write(eventParam[i].eventName);
                document.write('<button id="eventBtn" class="card-button" value="' + eventParam[i].eventValue + '">ボタン</button>');
                // document.write('<button id="eventBtn" value="' + eventParam[i].eventValue + '">' + eventparam[i].eventName + '</button>');
                document.write('</div>');
            }
        </script>

    </div>

    <div class="content">
        <h3>
            前提：MMCカスタマーIDまたはあとリビューショントークンが権限ONになっていること<br>
            説明：下記の項目を入力後、押下することでカスタマー更新をします。</h3>
    </div>
    <form>
        <script>
            let attributeParam = [{
                attributeKey : "customer_no",
                attributeName : "文字列",
                attributeBasic : "基本属性"
            },{
                attributeKey : "type",
                attributeName : "タイプ",
                attributeBasic : "基本属性"
            },{
                attributeKey : "text",
                attributeName : "テキスト",
                attributeBasic : "基本属性"
            },{
                attributeKey : "flag",
                attributeName : "フラグ",
                attributeBasic : "基本属性"
            }, {
                attributeKey : "number",
                attributeName : "数値",
                attributeBasic : "基本属性"
            }];

            for(var i=0;i<attributeParam.length;i++) {
                document.write('<div class="input-container">');
                document.write('<label for="inputField">型「' + attributeParam[i].attributeName + '」の入力: </label>');
                document.write('<input type="text" id="inputField' + (i+1) + '" >');
                document.write('<button class="submitButton" data-input="inputField' + (i+1) +'" data-attribute=' +attributeParam[i].attributeKey + ' >カスタマー更新する</button>');
                document.write('</div>');
            }
        </script>
    </form>
    <p>取得した値: <span id="output"></span></p>


    <script>
        document.querySelectorAll('.card-button').forEach(button => {
            button.addEventListener('click', eventIgnition);
        // イベント発火
        function eventIgnition() {
            // getCookies();
            const newUrl = window.location.origin + window.location.pathname + "?" + button.value;
            history.pushState(null, null, newUrl);
            // window.location.href = newUrl;
            // mc_tracker('EVENT' , button.value,{});
            // alert('イベント「' + button.value + '」を送信しました');
        }
        });

        function getCookies() {
            const cookies = document.cookie;
            const cookieArray = cookies.split(';');
            console.log(cookieArray);

            const cookieObject = {};
            cookieArray.forEach(cookie => {
            const [name, value] = cookie.split('=');
            cookieObject[name] = value;
        });
        console.log(cookieObject);
        }


        document.querySelectorAll(".submitButton").forEach(button => {
                    button.addEventListener("click", function(event) {
                        event.preventDefault(); // フォームの送信を防ぐ
                        var inputId = this.getAttribute("data-input");
                        var attributeKey = this.getAttribute("data-attribute");
                        console.log('"' + attributeKey + '"');
                        console.log('"' + inputId + '"');
                        var inputValue = document.getElementById(inputId).value; // 入力値を取得
                        document.getElementById("output").textContent = inputValue; // 取得した値を表示
                        mc_tracker('SET_ATTRIBUTES', {
                            [attributeKey] : '"' + inputValue + '"'
                        });
                        mc_tracker('SET_ATTRIBUTES', {
                            "name": "テスト"
                        });
                        alert('カスタマー属性「' + attributeKey + '」に「' + inputValue + '」を設定しました');
                    });
                });


                document.getElementById('clearCacheBtn').addEventListener('click', function() {
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    for (let name of names) {
                        caches.delete(name);
                    }
                });
                alert('キャッシュがクリアされました！');
            } else {
                alert('キャッシュAPIがサポートされていません。');
            }
        });
    </script>

</body>

</html>
